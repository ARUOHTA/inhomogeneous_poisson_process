# Gemini品質チェックプロトコル

## 概要
リファクタリング作業中に開発原則が守られているかを、Geminiとの対話を通じて客観的にチェックする。

## チェック頻度
1. **各フェーズ完了時**（必須）
2. **重要な設計変更時**
3. **大きなコード変更時**
4. **疑問が生じた時**

## チェック項目

### 1. DRY原則チェック
**質問例**:
```
以下のコードを確認してください。重複している部分はありますか？
より簡潔に書ける部分はありますか？

[コードを貼り付け]
```

### 2. 機能制限チェック
**質問例**:
```
以下の変更を確認してください。新機能が追加されていませんか？
既存機能のリファクタリングのみに留まっていますか？

変更前: [旧コード]
変更後: [新コード]
```

### 3. コード量チェック
**質問例**:
```
以下のリファクタリングでコード量は削減されていますか？
行数とファイル数の変化を評価してください。

変更前: X行、Yファイル
変更後: A行、Bファイル
```

### 4. 設計原則チェック
**質問例**:
```
以下の設計は適切ですか？過度な一般化になっていませんか？
必要最小限の抽象化に留まっていますか？

[設計コードを貼り付け]
```

## チェック結果の記録

### 記録場所
- **docs/refactoring_progress.md** に品質チェック結果を記録
- **docs/refactoring_issues.md** に問題があった場合は記録

### 記録フォーマット
```markdown
### 品質チェック結果 - [日付]
- **チェック対象**: [フェーズ/ファイル名]
- **チェック項目**: [DRY/機能制限/コード量/設計原則]
- **Gemini評価**: [評価結果]
- **改善点**: [指摘事項があれば]
- **対応**: [改善した場合の対応内容]
```

## Geminiとの対話手順

### Gemini起動
```bash
gemini
```

**注意**: Gemini使用前に認証設定が必要
- GEMINI_API_KEY環境変数の設定
- または.gemini/settings.jsonでの認証設定

1. **コンテキスト設定**
   ```
   私はベイズ統計プロジェクトのリファクタリングを行っています。
   以下の原則を守る必要があります：
   - DRY原則の徹底（重複コード排除）
   - 新機能追加禁止
   - コード量削減
   - 既存機能維持
   ```

2. **具体的質問**
   - 上記チェック項目から適切な質問を選択
   - コードや設計を具体的に提示

3. **評価受領**
   - Geminiの客観的評価を受け取り
   - 改善提案があれば検討・適用

4. **結果記録**
   - チェック結果をドキュメントに記録
   - 必要に応じて修正実施

## 注意事項

### Geminiに求める評価観点
- 客観性を重視
- 具体的な改善提案
- 原則違反の明確な指摘
- 代替案の提示

### チェック時の制約
- 秘密情報は含めない
- コードの一部のみを提示
- 評価結果は参考意見として扱う
