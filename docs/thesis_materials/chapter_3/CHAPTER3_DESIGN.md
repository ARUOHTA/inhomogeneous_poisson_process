# 第3章「関連研究」構成検討ノート

**最終更新**: 2026-01-12
**状態**: 構成検討中

---

## 1. 第3章の役割

### 論文全体における位置づけ

| 章 | 役割 | 主張 | 次章への橋渡し |
|----|------|------|---------------|
| 第2章 | データ説明 | データは3つの特性を持つ | これらに対応する手法が必要 |
| **第3章** | **既存手法の限界** | **既存手法は特性の一部のみ対応** | **統合的なモデルが必要** |
| 第4章 | 提案手法 | MMCPは3特性すべてに対応 | 実データで検証する |

### 第3章が答えるべき問い

> **「なぜMMCPが必要なのか」を読者に納得させること**

具体的には：
- 各特性に対応する既存手法は何か？
- それぞれの手法の貢献と限界は何か？
- なぜこれまで統合されてこなかったのか？
- 本研究はどのように位置づけられるか？

---

## 2. 論理構成（確定事項）

### 主張（1文）

> 黒曜石データの3つの特性（presence-only、組成データ、空間的依存性）に対応する既存手法はそれぞれ存在するが、いずれも特性の一部のみに対応しており、3特性すべてを統合的に扱うモデルは存在しない。

### 各節の構造（統一）

```
理論 → 隣接分野での応用 → 数理的課題 → 限界
```

### 書くべき3つのレベル

| レベル | 内容 | 例 |
|--------|------|-----|
| A. データ特性 | 本研究のデータ固有の問題 | 3特性への対応 |
| B. 隣接分野 | 生態学などでの類似問題 | Moreira、SDM |
| C. 数理的課題 | 統合を困難にする技術的問題 | 非共役性、計算量 |

### 詳細度の方針

- **書く**：何が課題か、なぜ難しいか（概念レベル）
- **書かない**：詳細な導出、アルゴリズムの詳細（第4章・付録に回す）

---

## 3. 構成案（確定）

### 確定した構成

```
3.1 本章の目的（0.5ページ）
    - 本研究のデータが持つ3つの特性を再確認
    - 各特性に対応する既存手法を整理する目的を述べる

3.2 空間的依存性のモデリング（2ページ）
    3.2.1 ガウス過程による空間効果
        - GPの基本（共分散関数、条件付き分布）
        - 計算量の課題：O(n³)
    3.2.2 近傍ガウス過程（NNGP）
        - 条件付き分解と近傍制限
        - 計算量O(n)へのスケーラビリティ
        【引用】Datta et al. (2016)
    3.2.3 限界
        - 連続値応答を仮定
        - 組成データ・点過程との統合例なし

3.3 組成データのモデリング（2.5ページ）
    3.3.1 組成データの特性
        - 単体制約、対数比変換
    3.3.2 多項ロジットモデルと非共役性
        - softmax vs stick-breaking表現
        - 効率的MCMCが困難
    3.3.3 Pólya-Gamma補助変数法
        - 二項分布への適用
        - 多項分布への拡張（stick-breaking + ブロック更新）
        【引用】Polson et al. (2013), Linderman et al. (2015)
    3.3.4 限界
        - 空間効果・点過程との統合なし

3.4 Presence-onlyデータのモデリング（2.5ページ）
    3.4.1 点過程モデルの基礎
        - 非均質ポアソン点過程
        - 強度関数の積分計算の困難さ
        【引用】Renner et al. (2015)
    3.4.2 偽不在アプローチ
        - データ拡張による厳密ベイズ推論
        - 3つの潜在過程（観測・未観測・偽不在）
        【引用】Moreira & Gamerman (2022)
    3.4.3 限界
        - 単一種のみ：マーク（組成）との統合なし

3.5 既存手法の限界と本研究の位置づけ（1.5ページ）
    3.5.1 各手法の対応範囲（比較表）
    3.5.2 なぜ統合されてこなかったか
        - 各手法は異なる分野で発展
        - 組成マーク付き点過程のベイズ推論は先行研究なし
        【引用】Eckardt et al. (2025), Gelfand & Shirota (2019)
    3.5.3 本研究の貢献と第4章への橋渡し
```

### 決定事項

- [x] NW推定量：第5章のベースライン手法として扱う（第3章では言及しない）
- [x] 節の順序：技術的依存関係順（空間→組成→Presence-only→統合）
- [x] 分量配分：全体で約9ページ

---

## 4. 5つの論点と調査項目

### 論点1：空間的依存性のモデリング

| 問い | 調べること | 状態 |
|------|-----------|------|
| GPの限界は何か？ | 計算量O(n³)、大規模データへの適用困難 | |
| NNGPは何を解決したか？ | Datta et al. (2016)の貢献 | |
| NNGPの適用範囲は？ | 連続値への適用が主、組成データへの適用例は？ | |
| **残された課題** | NNGPを組成データ・点過程と組み合わせた例はあるか？ | |

**関連論文**: `datta2016.md`, `goncalves_gamerman2018.md`

---

### 論点2：組成データのモデリング

| 問い | 調べること | 状態 |
|------|-----------|------|
| 組成データの本質的困難は？ | 単体制約、対数比変換（Aitchison） | |
| 多項ロジットの推論の困難は？ | 非共役性、効率的なMCMCが困難 | |
| PGは何を解決したか？ | Polson et al. (2013)の貢献、2値→多項への拡張 | |
| **残された課題** | 多項ロジット+GP（空間効果）の先行研究はあるか？効率的な推論は？ | |

**関連論文**: `polson2012.md`, `linderman2015.md`, `eckardt2025.md`

---

### 論点3：Presence-onlyデータのモデリング（★核心）

| 問い | 調べること | 状態 |
|------|-----------|------|
| 従来の点過程の困難は？ | 強度関数の積分計算が必要 | |
| 偽不在アプローチの貢献は？ | Moreira & Gamerman (2022)が何を解決したか | |
| 生態学での応用は？ | SDM（種分布モデル）での使われ方 | |
| **残された課題** | 偽不在+マーク（組成）を同時モデル化した例はあるか？ | |

**関連論文**: `moreira2022.md`, `moreira2024.md`, `renner2015.md`, `gelfand_schliep2018_main.md`, `gelfand_shirota2019.md`

**重要**: Moreira & Gamermanが本研究の基盤。「マークを扱っていない」という限界を明示することが核心。

---

### 論点4：なぜ統合されてこなかったか？（★核心）

| 問い | 調べること | 状態 |
|------|-----------|------|
| 技術的障壁は何か？ | 非共役性×空間効果×点過程の組み合わせ | |
| 各分野の「壁」 | 空間統計、点過程、組成データ解析は別々に発展 | |
| 統合の試みはあったか？ | 部分的な統合（2特性）の先行研究 | |

**関連論文**: `eckardt2025.md`, `gelfand_shirota2019.md`, `moreira2024.md`

**重要**: 「なぜ今まで誰もやらなかったのか」に答えることで新規性が際立つ。

---

### 論点5：本研究の位置づけ

| 問い | 調べること | 状態 |
|------|-----------|------|
| 各先行研究から何を借りたか？ | 偽不在（Moreira）、NNGP（Datta）、PG（Polson） | |
| 本研究の拡張・貢献は何か？ | 4要素の統合、距離事前分布の導入 | |

---

## 5. 変換済み論文リスト

| ファイル | 論文 | 関連論点 | 読込状態 | メモ |
|---------|------|---------|---------|------|
| `moreira2022.md` | Moreira & Gamerman (2022) | 論点3 | 未読み直し | 偽不在点過程の基盤論文 |
| `moreira2024.md` | Moreira et al. (2024) | 論点3・4 | 未読み直し | |
| `polson2012.md` | Polson et al. (2013) | 論点2 | 未読み直し | PGの原論文 |
| `linderman2015.md` | Linderman et al. (2015) | 論点2 | 未読み直し | PGの多項拡張 |
| `renner2015.md` | Renner et al. (2015) | 論点3 | 未読み直し | SDMでのpresence-only |
| `datta2016.md` | Datta et al. (2016) | 論点1 | 未読み直し | NNGPの原論文 |
| `eckardt2025.md` | Eckardt et al. (2025) | 論点2・3・4 | 未読み直し | |
| `gelfand_schliep2018_main.md` | Gelfand & Schliep (2018) | 論点3 | 未読み直し | |
| `gelfand_shirota2019.md` | Gelfand & Shirota (2019) | 論点3・4 | 未読み直し | |
| `goncalves_gamerman2018.md` | Gonçalves & Gamerman (2018) | 論点1・3 | 未読み直し | |

**ファイルの場所**: `docs/literature/*.md`

---

## 6. 先行研究との関係（TODO）

| 本研究の要素 | 基盤となる先行研究 | 本研究での拡張・貢献 |
|-------------|-------------------|---------------------|
| 点過程（偽不在） | Moreira & Gamerman (2022) | [TODO] |
| 多項ロジット+GP | [TODO] | 距離事前分布の導入 |
| NNGP | Datta et al. (2016) | [TODO] |
| Pólya-Gamma | Polson et al. (2013) | [TODO] |
| 組成データ | Aitchison (1982) | [TODO] |

---

## 7. 論文要約

### Moreira & Gamerman (2022) - 偽不在点過程の基盤論文

**タイトル**: Analysis of Presence-Only Data via Exact Bayes, with Model and Effects Identification

**関連論点**: 論点3（Presence-only）、論点4（統合の困難さ）

#### 問題設定・動機

- Presence-onlyデータ（存在地点のみが記録されるデータ）の分析
- 従来のIPP（非均質ポアソン過程）は強度関数の積分計算が必要で近似に依存
- Preferential sampling（選好的サンプリング）：観測されやすい場所にデータが偏る問題

#### 提案手法の概要

**データ拡張による厳密ベイズ推論**：

強度関数を $\lambda(s) = q(s) \lambda^*$ とパラメータ化し、3つの潜在過程を導入：

1. $X \sim \text{IPP}(q(\cdot)p(\cdot)\lambda^*)$ — 観測された存在地点
2. $X' \sim \text{IPP}(q(\cdot)(1-p(\cdot))\lambda^*)$ — 観測されなかった存在地点
3. $U \sim \text{IPP}((1-q(\cdot))\lambda^*)$ — 偽不在点（pseudo-absence）

ここで $q(s)$, $p(s)$ はロジスティック関数。

**キーポイント**：
- $q(\cdot)p(\cdot) + q(\cdot)(1-p(\cdot)) + (1-q(\cdot)) = 1$ により積分が解析的に計算可能
- ギブスサンプラーで推論
- Pólya-Gamma補助変数法でロジスティック回帰パラメータをサンプリング

#### 本研究との関係

| 借りたもの | 違い・拡張 |
|-----------|-----------|
| 偽不在点過程のフレームワーク | **マーク（組成）を扱っていない** |
| データ拡張による厳密推論 | 本研究は多項マークを追加 |
| Pólya-Gamma補助変数法の活用 | 本研究はNNGPによる空間効果を導入 |

#### 限界（第3章で強調すべき点）

- **単一種のみ**：マーク付き点過程ではない
- **空間効果**：GPによるものではなく、共変量ベースのみ
- **組成データとの統合なし**：多種分布・組成データの同時モデル化は今後の課題として言及

#### 引用されている重要文献

- Gonçalves & Gamerman (2018) — 時空間Cox過程
- Polson et al. (2013) — Pólya-Gamma
- Gelfand & Schliep (2018) — 点パターンのベイズ推論
- Gelfand & Shirota (2019) — Preferential sampling

#### 第3章での使い方

論点3で「偽不在アプローチが何を解決したか」を説明する際の中心文献。
論点4で「マーク（組成）との統合がまだ行われていない」という限界を示す根拠。

---

### Eckardt et al. (2025) - 組成マーク付き空間点過程

**タイトル**: On spatial point processes with composition-valued marks

**関連論点**: 論点2（組成データ）、論点4（統合の困難さ）

#### 問題設定・動機

- マーク付き空間点過程の分析において、組成データマーク（composition-valued marks）を扱う手法がなかった
- 組成マーク：D個の成分が総和1（または100%）の制約を持つベクトル値マーク
- 例：害虫感染率、ビジネスセクター構成比、樹木バイオマス比率

#### 提案手法の概要

**記述統計・探索的データ分析の手法**：

- Aitchison (1986)の組成データ解析の原則を空間点過程に適用
- 変換：log-ratio (lr), additive log-ratio (alr), centered log-ratio (clr), isometric log-ratio (ilr)
- 各種マーク特性関数を組成データに拡張：
  - マーク相関関数 $\kappa_{mm}(r)$
  - マークバリオグラム $\gamma_{mm}(r)$
  - Shimatani's I, Schlather's I

#### 本研究との関係

| 類似点 | 違い |
|--------|------|
| 空間点過程 + 組成マーク | **推論手法が異なる**：記述統計 vs ベイズ推論 |
| | **モデリングなし**：パラメトリックモデルは扱わない |
| | **Presence-onlyでない**：強度関数のモデル化なし |
| | **予測目的でない**：探索的データ分析が目的 |

#### 限界（第3章で強調すべき点）

- **ベイズ推論・予測モデルではない**：記述統計に留まる
- **点過程の強度関数をモデル化していない**：presence-onlyデータへの対応なし
- **空間効果のパラメトリックモデル化なし**：GPやNNGPとの統合がない

#### 第3章での使い方

論点2で「組成マークを持つ点過程の先行研究」として言及。
ただし、本研究とは異なるアプローチ（記述統計 vs ベイズ推論）であり、**モデルベースの予測や推論を行う本研究とは目的が異なる**ことを明確にする。

**重要な発見**：組成マーク付き点過程でベイズ推論を行う先行研究はほぼ存在しない可能性がある。Eckardt et al. (2025)は記述統計のみで、モデルベースの推論は行っていない。

---

### Gelfand & Shirota (2019) - Preferential samplingとデータ融合

**タイトル**: Preferential sampling for presence/absence data and for fusion of presence/absence data with presence-only data

**関連論点**: 論点3（Presence-only）、論点4（統合の困難さ）

#### 問題設定・動機

1. **Presence/absenceとPresence-onlyの本質的な違い**：
   - Presence/absence：位置が**固定**、ベルヌーイ試行
   - Presence-only：位置が**ランダム**、点過程
   - 「存在確率」の定義が2つのデータタイプ間で**互換性がない**

2. **既存文献への批判**：
   - 多くの研究がこの非互換性を無視
   - Presence-onlyフレームワークからPresence/absenceモデリングを導出できるとする主張に異議（Dorazio 2014, Royle et al. 2012等への反論）

3. **Preferential sampling（選好的サンプリング）**：
   - サンプリング位置が観測値と**独立でない**問題
   - 生態学者は種を見つけやすい場所でサンプリングする傾向 → 推論にバイアス

#### 提案手法の概要

**1. 点レベルでのPresence/absenceモデリング**：

$$Y(\mathbf{s}) \sim \text{Bernoulli}(p(\mathbf{s}))$$
$$\log \frac{p(\mathbf{s})}{1-p(\mathbf{s})} = \mathbf{x}^T(\mathbf{s})\boldsymbol{\alpha} + \omega(\mathbf{s})$$

ここで $\omega(\mathbf{s})$ はガウス過程による空間効果。

**2. Shared process model**：

- Presence/absenceデータとサンプリング位置で**共通のGP** $\omega(\mathbf{s})$ を共有
- サンプリング位置の点過程も $\omega(\mathbf{s})$ に依存させることで、選好的サンプリングによるバイアスを補正

**3. データ融合**：

- Presence/absenceデータとPresence-onlyデータの確率論的に整合的な融合
- 両データソースを同一モデル内で扱う

#### 本研究との関係

| 類似点 | 違い |
|--------|------|
| 点レベルでのモデリング | **単一種のみ**：組成データ・マークなし |
| ガウス過程による空間効果 | **Moreira & Gamermanとは異なるアプローチ** |
| Presence-onlyデータの扱い | Shared process model vs 偽不在アプローチ |

#### 限界（第3章で強調すべき点）

- **単一種のみ**：マーク付き点過程ではない
- **組成データとの統合なし**：多種分布・組成比のモデル化なし
- **Moreira & Gamermanとの違い**：
  - Gelfand & Shirota：shared process model（GP共有）
  - Moreira & Gamerman：偽不在点過程（データ拡張）
  - 本研究はMoreira & Gamermanの偽不在アプローチを採用

#### 第3章での使い方

論点3で「Presence-onlyデータのモデリングには複数のアプローチが存在する」ことを示す際に言及。
論点4で「shared process modelも組成データとは統合されていない」という根拠。

**本研究との位置関係**：本研究はGelfand & Shirotaのshared processではなく、Moreira & Gamermanの偽不在アプローチを採用。理由は偽不在アプローチの方がマーク付き点過程への拡張が自然なため（要検討）。

---

### Datta et al. (2016) - NNGPの原論文

**タイトル**: Hierarchical Nearest-Neighbor Gaussian Process Models for Large Geostatistical Datasets

**関連論点**: 論点1（空間的依存性）

#### 問題設定・動機

1. **GPの計算量問題**：
   - 共分散行列の逆行列・行列式計算に $O(n^3)$ フロップス
   - ストレージは $O(n^2)$
   - $n$ が大きいと計算不可能

2. **既存手法の限界**：
   - 低ランク近似（Predictive Process等）：ノット数 $r$ に依存、$O(nr^2)$ でも大規模データには不十分
   - 隣接点間の強い相関を捉えにくい（Stein 2014）
   - スパース法（tapering等）：尤度近似には有効だが、完全な過程ベースの推論には不十分

#### 提案手法の概要

**Nearest-Neighbor Gaussian Process (NNGP)**：

GPの同時分布を条件付き分布の積に分解し、各点の条件付け集合をm個の近傍のみに制限：

$$\tilde{p}(\mathbf{w}_{\mathcal{S}}) = \prod_{i=1}^{k} p(\mathbf{w}(\mathbf{s}_i) | \mathbf{w}_{N(\mathbf{s}_i)})$$

ここで $N(\mathbf{s}_i)$ は $\mathbf{s}_i$ の $m$ 個の最近傍（$m \ll n$）。

**計算量削減**：
- 精度行列（共分散逆行列）がスパースに
- 1イテレーションあたり $O((n+k)m^3)$ フロップス
- **$n$ に対して線形**（$m$ は通常10-15で十分）
- ストレージも大幅削減

**理論的保証**：
- NNGPは正当な空間過程（Kolmogorovの整合性条件を満たす）
- 任意の位置での有限次元分布が定義可能
- 階層モデルの事前分布として使用可能

#### 本研究との関係

| 借りたもの | 本研究での使い方 |
|-----------|-----------------|
| 空間効果の効率的モデリング | 組成データの空間構造をNNGPで表現 |
| 計算量 $O(n)$ のスケーラビリティ | 大規模な黒曜石データへの適用を可能に |
| 階層モデルへの組み込み | 多項ロジット+NNGP空間効果の統合 |

#### 限界・注意点

- 近傍数 $m$ の選択に依存（経験的には10-15で十分）
- 順序付けに依存（ただし経験的には影響小さい）
- **非ガウス応答への拡張**：Section 4.3でGLMへの適用に言及あり → 本研究の多項ロジットへの適用を支持

#### 引用されている重要文献

- Vecchia (1988) — NNGPの基礎となる条件付き分解
- Stein et al. (2004) — 近傍ベースの尤度近似
- Banerjee et al. (2008) — Predictive Process（低ランク近似）

#### 第3章での使い方

論点1で「GPの計算量問題とNNGPによる解決」を説明する際の中心文献。
本研究がNNGPを採用する根拠として引用。

---

### Polson et al. (2013) - Pólya-Gamma補助変数法

**タイトル**: Bayesian inference for logistic models using Pólya-Gamma latent variables

**関連論点**: 論点2（組成データ・多項ロジット）

#### 問題設定・動機

1. **ロジスティック回帰の推論困難**：
   - ベイズロジスティック回帰では、尤度関数が解析的に不便な形式
   - プロビットモデルのAlbert & Chib (1993)の方法は簡単（潜在変数法）
   - ロジットへの同様のアプローチは「近似」か「複雑な多層潜在変数」が必要だった

2. **既存手法の限界**：
   - Holmes & Held (2006)：Kolmogorov-Smirnov分布を用いた尺度混合 → 複雑
   - Frühwirth-Schnatter & Frühwirth (2010)：正規分布の離散混合 → 近似
   - いずれも2層以上の潜在変数が必要

#### 提案手法の概要

**Pólya-Gamma (PG) 分布**：

$X \sim PG(b, c)$ のとき、

$$X \stackrel{D}{=} \frac{1}{2\pi^2} \sum_{k=1}^{\infty} \frac{g_k}{(k-1/2)^2 + c^2/(4\pi^2)}$$

ここで $g_k \sim \text{Ga}(b, 1)$ は独立なガンマ確率変数。

**主定理（Theorem 1）**：

二項尤度（対数オッズでパラメータ化）はPG分布に関するガウス分布の混合として表現可能：

$$\frac{(e^\psi)^a}{(1+e^\psi)^b} = 2^{-b} e^{\kappa\psi} \int_0^\infty e^{-\omega\psi^2/2} p(\omega) d\omega$$

ここで $\kappa = a - b/2$、$\omega \sim PG(b, 0)$。

**ギブスサンプラー**：

以下の2ステップを反復するだけで事後分布からサンプリング可能：

1. $(\omega_i | \boldsymbol{\beta}) \sim PG(n_i, x_i^T\boldsymbol{\beta})$
2. $(\boldsymbol{\beta} | y, \omega) \sim N(m_\omega, V_\omega)$

ここで $V_\omega = (X^T\Omega X + B^{-1})^{-1}$、$m_\omega = V_\omega(X^T\kappa + B^{-1}b)$。

#### 主な利点

| 特性 | 既存手法 | PG法 |
|------|---------|------|
| 潜在変数の層数 | 2層以上 | **1層のみ** |
| 推論の厳密性 | 近似が多い | **厳密** |
| 階層モデルへの拡張 | 困難 | **容易** |
| 実装の簡潔さ | 複雑 | **シンプル** |

#### 本研究との関係

| 借りたもの | 本研究での使い方 |
|-----------|-----------------|
| ロジスティック回帰の効率的サンプリング | 多項ロジットでの組成比のギブスサンプリング |
| 単層潜在変数による簡潔なアルゴリズム | NNGP・偽不在との統合時もサンプラーがシンプルに保たれる |
| 階層モデルへの容易な拡張 | 空間効果（NNGP）との組み合わせを可能に |

#### 多項ロジットへの拡張

- 論文のTechnical supplementで「contingency tables and multinomial outcomes」への拡張に言及
- Linderman et al. (2015)で多項ロジットへの詳細な拡張が行われる（Round 3で読込予定）
- **本研究の組成データ（多項分布）への適用の理論的基盤**

#### 限界・注意点

- $PG(n, c)$ の生成は $n$ 個の $PG(1, c)$ の和として計算 → 大きな $n$ では遅くなる可能性
- 本論文はバイナリロジットが主眼 → 多項への拡張はLinderman (2015)を参照

#### 第3章での使い方

論点2で「多項ロジットの非共役性問題とPGによる解決」を説明する際の中心文献。
論点5で「本研究はPGを借りて組成データの効率的推論を実現」と位置づけ。

---

### Renner et al. (2015) - SDMにおける点過程モデルの総説

**タイトル**: Point process models for presence-only analysis

**関連論点**: 論点3（Presence-only）

#### 論文の位置づけ

生態学における種分布モデル（SDM）のためのpresence-only分析について、点過程モデル（PPM）の観点から包括的にレビューした総説論文。MaxEnt、ロジスティック回帰、点過程モデルの関係を明確化。

#### 主な内容

**1. Presence-onlyデータとは**

- 存在地点のみが記録されたデータ（不在情報なし）
- 博物館、アトラス、標本館に蓄積
- 点事象（point events）として自然に解釈される

**2. 点過程モデル（PPM）の利点**

| 利点 | 説明 |
|------|------|
| 応答変数の明確化 | 強度関数 $\lambda(s)$ を明示的にモデル化 |
| Quadrature点の客観的選択 | 数値積分の観点から理論的に正当化 |
| 仮定のチェック | 残差分析、Kプロット等の診断ツール |
| 空間依存性への対応 | Gibbs過程、Cox過程による拡張 |
| サンプリングバイアスへの対処 | 共変量としてバイアス源を明示的にモデル化 |

**3. 点過程モデルの分類**

| タイプ | 特徴 | 適用場面 |
|--------|------|---------|
| Poisson PPM | 点が独立、$\ln \lambda(s) = \mathbf{x}(s)'\boldsymbol{\beta}$ | 空間依存性がない場合 |
| Gibbs過程 | 点間の相互作用を明示 | クラスタリング・反発がある場合 |
| Cox過程（LGCP） | 潜在ガウス過程を導入 | 空間的相関を柔軟にモデル化 |

**4. Quadrature点（Pseudo-absence）の役割**

- 尤度関数の積分 $\int_\mathcal{A} \lambda(s) ds$ を近似するためのもの
- **数値積分の観点**から選択すべき（存在点との「マッチング」は不要）
- 収束を確認するまで点数を増やす（例では10万点以上が必要だった）
- 正則格子 vs ランダムサンプリング

**5. 既存手法との関係**

| 手法 | PPMとの関係 |
|------|------------|
| MaxEnt | Poisson PPMと**等価** (Fithian & Hastie 2013) |
| 背景点ロジスティック回帰 | Poisson PPMの**近似** |
| Naïve回帰 | 背景点(y=0)を存在(y=1)と対比 → スケール不定 |

#### 本研究との関係

| 関連項目 | 本研究での扱い |
|---------|---------------|
| Presence-onlyデータの扱い | Moreira & Gamermanの偽不在アプローチを採用 |
| 点過程モデルの枠組み | 非均質ポアソン点過程の尤度構造を活用 |
| Cox過程（LGCP） | 本研究はNNGPを空間効果に使用（Cox過程と類似のアイデア） |
| Quadrature点 | 偽不在点として理論的に正当化される |

#### 限界・注意点

- **単一種のみ**：マーク付き点過程への拡張は「Extensions」で言及のみ
- **組成データとの統合なし**：多種分布の同時モデル化は扱っていない
- 本論文はレビュー論文であり、新規手法の提案ではない

#### 重要な引用文献（本研究に関連）

- **Warton & Shepherd (2010)** — 背景点回帰とPPMの等価性
- **Fithian & Hastie (2013)** — MaxEntとPPMの等価性
- **Diggle (2003)** — 点過程モデルの基礎
- **Møller, Syversveen & Waagepetersen (1998)** — Log-Gaussian Cox過程

#### 第3章での使い方

論点3で「Presence-onlyデータを点過程として扱う枠組み」を説明する際の基本文献。
SDMコミュニティでの議論状況を示し、本研究が点過程モデルの枠組みに位置づけられることを明確にする。
Moreira & Gamermanの偽不在アプローチが、このPPM枠組みの中でどう位置づけられるかを説明する根拠として使用。

---

### Linderman et al. (2015) - PGの多項分布への拡張

**タイトル**: Dependent Multinomial Models Made Easy: Stick Breaking with the Pólya-Gamma Augmentation

**関連論点**: 論点2（組成データ・多項ロジット）

#### 問題設定・動機

1. **多項分布の依存性モデリング**：
   - 多項分布パラメータ間に相関を導入したい（Correlated Topic Model等）
   - Dirichlet-Multinomialでは依存性を自然に表現できない
   - Logistic normalは非共役で推論が困難

2. **既存PG法の限界**：
   - Polson et al. (2013)のPG法は2値ロジットが主眼
   - Logistic normalへの適用（Chen et al. 2013）は**single-site更新のみ**
   - ブロック更新ができず、ミキシングが遅い

#### 提案手法の概要

**Stick-breaking表現**：

K次元多項分布を K-1 個の二項分布の積として再帰的に表現：

$$\text{Mult}(\mathbf{x} | N, \boldsymbol{\pi}) = \prod_{k=1}^{K-1} \text{Bin}(x_k | N_k, \tilde{\pi}_k)$$

ここで $N_k = N - \sum_{j<k} x_j$、$\tilde{\pi}_k = \pi_k / (1 - \sum_{j<k} \pi_j)$。

各 $\tilde{\pi}_k = \sigma(\psi_k)$ とパラメータ化し、$\boldsymbol{\psi}$ にガウス事前分布を置く。

**Pólya-Gamma補助変数の導入**：

各座標 $\psi_k$ に対してPG変数 $\omega_k$ を導入すると、条件付きで：

$$p(\mathbf{x}, \boldsymbol{\omega} | \boldsymbol{\psi}) \propto \mathcal{N}(\boldsymbol{\Omega}^{-1}\kappa(\mathbf{x}) | \boldsymbol{\psi}, \boldsymbol{\Omega}^{-1})$$

ここで $\boldsymbol{\Omega} = \text{diag}(\boldsymbol{\omega})$、$\kappa(\mathbf{x}) = \mathbf{x} - N(\mathbf{x})/2$。

**→ 条件付きでガウス尤度になり、ブロック更新が可能！**

#### 主な利点

| 特性 | Logistic Normal + PG | **Stick-breaking + PG** |
|------|---------------------|-------------------------|
| 更新方式 | single-site | **ブロック更新** |
| ミキシング効率 | 遅い | **高速** |
| 既存コード活用 | 困難 | **GP・LDSコードをそのまま使用可能** |

#### アプリケーション（論文内）

1. **Correlated Topic Model (CTM)**: トピック間の相関をモデル化
2. **Gaussian Process + Multinomial**: 空間的に変化する多項分布
3. **Multinomial Linear Dynamical System**: 時系列の多項データ

#### 本研究との関係

| 借りたもの | 本研究での使い方 |
|-----------|-----------------|
| Stick-breaking表現 | 組成データ（黒曜石比率）のモデル化 |
| ブロック更新可能なPG法 | 効率的なギブスサンプラー構築 |
| GP + Multinomialの統合 | NNGP空間効果 + 多項ロジットの統合に直接適用 |

#### 核心的な貢献（本研究への示唆）

本論文のSection 4（Gaussian processes with multinomial observations）は、まさに本研究が必要とする**「空間効果（GP）+ 多項分布」の統合方法**を示している：

$$\boldsymbol{\psi}_{:,k} \sim \mathcal{GP}(\boldsymbol{\mu}_k, \mathbf{C}), \quad \mathbf{x}_m \sim \text{Mult}(N_m, \boldsymbol{\pi}_{\text{SB}}(\boldsymbol{\psi}_{m,:}))$$

本研究では $\mathcal{GP}$ を $\text{NNGP}$ に置き換えることで、大規模データへの適用が可能。

#### 第3章での使い方

論点2で「多項ロジットへのPG拡張」を説明する際の中心文献。
Polson et al. (2013)からLinderman et al. (2015)への流れを示し、本研究が多項分布 + 空間効果の統合に必要な技術基盤を持つことを説明。

---

## 8. 作業ログ

### 2026-01-12

- 本ファイル作成
- PROGRESS.mdの情報を整理・転記
- 今後の作業：論文を読み直し、各論点を埋めていく
- **moreira2022.md読込完了** — 偽不在点過程の基盤論文
- **eckardt2025.md読込完了** — 組成マーク付き点過程（記述統計のみ、ベイズ推論なし）
- **gelfand_shirota2019.md読込完了** — Preferential sampling、Moreira & Gamermanとは異なるアプローチ
- **datta2016.md読込完了** — NNGPの原論文、$O(n)$スケーラビリティ
- **polson2012.md読込完了** — Pólya-Gamma補助変数法、ロジスティック回帰の効率的サンプリング
- **renner2015.md読込完了** — SDMにおける点過程モデルの総説
- **linderman2015.md読込完了** — PGの多項分布への拡張（Stick-breaking + ブロック更新）

#### Round 2 + Linderman読込 完了 ✅

#### Round 2 完了後の発見

1. **各論点の技術的基盤が明確化**：
   - **論点1（空間依存性）**: NNGPはGPを$O(n)$に近似、大規模データへの適用を可能にする
   - **論点2（組成データ）**: PGは非共役性問題を解決、単層潜在変数でギブスサンプラー構築可能
   - **論点3（Presence-only）**: 点過程モデルの枠組みが確立、偽不在は「quadrature点」として理論的に正当化

2. **本研究の技術的位置づけが明確化**：
   - **NNGP**: GPの計算量問題を解決 → 大規模空間データに対応
   - **Pólya-Gamma**: ロジスティック・多項ロジットの非共役性を解決 → 組成データのギブスサンプリング
   - **偽不在点過程**: Presence-onlyの尤度計算を可能に → Moreira & Gamermanの枠組み

3. **統合の困難さ（論点4）への示唆**：
   - 各手法は**別々の分野で発展**（地理統計 / 計量心理学 / 生態学）
   - 組み合わせの先例がない
   - 本研究は3つの技術を統合する初の試み

#### Round 1 完了後の発見

1. **組成マーク付き点過程でベイズ推論を行う先行研究は存在しない**
   - Eckardt et al. (2025)は記述統計のみ
   - Moreira & Gamerman (2022)は単一種のみ（マークなし）
   - Gelfand & Shirota (2019)も単一種のみ

2. **Presence-onlyには2つのアプローチ**：
   - 偽不在アプローチ（Moreira & Gamerman）→ 本研究が採用
   - Shared process model（Gelfand & Shirota）

3. **本研究の新規性が明確**：
   - 「偽不在点過程 + 組成マーク + NNGP」の統合は初

---

## 9. 追加取得候補論文

Round 1で読んだ論文から引用されていて、詳細確認が望ましい論文：

### 高優先度（取得推奨）

| 論文 | 引用元 | 理由 | 取得状態 |
|------|--------|------|---------|
| **Diggle et al. (2010)** | Gelfand & Shirota (2019) | Preferential samplingの原論文。概念の出典として言及必須 | 未取得 |
| **Warton & Shepherd (2010)** | SDM文献 | Poisson point process for presence-only。偽不在の別アプローチ | 未取得 |

### 中優先度（余裕があれば）

| 論文 | 引用元 | 理由 | 取得状態 |
|------|--------|------|---------|
| Aitchison (1986) | Eckardt et al. (2025) | 組成データ解析の教科書。基礎概念の確認用 | 未取得 |
| Banerjee, Carlin, Gelfand (2014) | 複数 | 空間統計の教科書。NNGPの背景説明に有用 | 未取得 |

### 取得不要（すでに変換済み）

- Gelfand & Schliep (2018) → `gelfand_schliep2018_main.md`
- Dorazio (2014) → `dorazio2014.md`
- Fithian & Hastie (2013) → `fithian_hastie2013.md`

---

## 次のアクション

1. [x] `moreira2022.md`を読み込む
2. [x] `eckardt2025.md`を読み込む
3. [x] `gelfand_shirota2019.md`を読み込む
4. [x] Round 2: 基盤論文の読込
   - [x] `datta2016.md`（NNGP）
   - [x] `polson2012.md`（Pólya-Gamma）
   - [x] `renner2015.md`（SDM総説）
5. [x] `linderman2015.md`を読み込む（PGの多項拡張）
6. [x] 構成案の最終確定
7. [x] 3.RelatedWork.texの執筆開始（初版完了 2026-01-12）
