# 組成データ分析（CoDA）の基礎文献と理論的ポイント

**要点**  
組成データは「総和が一定（通常1）」という制約を持つため、通常の多変量解析をそのまま適用すると共分散構造の退化やスプリアス相関など、深刻な問題が生じる。Aitchison (1982, 1986) は、単体（simplex）を標本空間とみなし、「比・対数比」に基づく幾何と対数比変換を導入することで、この問題を体系的に解決した。

***

## 1. Aitchison (1982, 1986) の正確な書誌情報

### 1-1. Aitchison (1982) 論文

- **著者**: John Aitchison  
- **タイトル**: *The Statistical Analysis of Compositional Data*  
- **誌名**: Journal of the Royal Statistical Society. Series B (Methodological)  
- **巻(号)**: 44(2)  
- **ページ**: 139–177[1][2]
- **発行年**: 1982  

この論文は、組成データ解析という用語と、その理論的枠組み（単体上の分布、独立性の概念、対数正規変換など）を初めて体系的に提示した「始祖的」文献と位置付けられている。[3][2]

### 1-2. Aitchison (1986) 書籍

- **著者**: John Aitchison  
- **タイトル**: *The Statistical Analysis of Compositional Data*  
- **出版社**: Chapman and Hall  
- **出版地**: London (and New York)  
- **ページ数**: xii + 416 pp.[4][5]
- **発行年**: 1986  
- **書誌情報例（図書館・カタログ形式）**:  
  Aitchison, J. (1986). *The Statistical Analysis of Compositional Data*. London: Chapman and Hall.[5][4]

この本は、1982年論文で提示されたアイデアを大幅に拡張し、組成データの幾何（Aitchison geometry）、対数比変換、分布論、回帰・判別・クラスターなど、多変量統計法への展開を包括的に解説した古典的モノグラフであり、現在でも標準的な基礎文献として引用され続けている。[6][7][8]

***

## 2. 単体（simplex）上のデータの統計的課題

### 2-1. 単体としての標本空間

D 次元組成データは、各成分が正で総和が一定 \(\kappa\)（通常1）という制約を持つため、標本空間はユークリッド空間 \(\mathbb{R}^D\) ではなく、**単体（simplex）** となる。[9]

\[
\mathcal{S}^D = \left\{\mathbf{x} = (x_1,\dots,x_D) \in \mathbb{R}^D \,\middle|\, x_i > 0,\; \sum_{i=1}^D x_i = \kappa \right\}
\]

このような空間上で「普通の」多変量統計を行うと、次のような問題が生じることを Aitchison は強調した。[10][7]

### 2-2. 統計的課題（代表的なもの）

**(1) 共分散行列の退化と解釈困難性**  
総和制約 \(\sum x_i = \kappa\) のため、成分間には必ず線形従属関係があり、観測ベクトルの有効な次元は \(D-1\) になる。このため、  
- 生の組成ベクトルの共分散行列は**特異（rank が \(D-1\)）**となる  
- 共分散・相関の解釈が、単なる「比の制約」の影響と真の関係が混ざり合う  

結果として、通常の多変量正規モデルや共分散に基づく手法（PCA 等）をそのまま用いると、**見かけ上の負の相関**など、誤解を招く結果が得られやすい。[7][8][10]

**(2) スプリアス相関（spurious correlation）**  
組成の各成分は、総和制約により互いに「引きずり合う」ため、  
- 実際には物理的・科学的な関連がなくても、  
- 総和制約のみを原因とする**偽の相関**が観測される  

Pearson (1897) に端を発し、Aitchison (1986) でも詳しく議論されている。[8]

**(3) 単体から外れる操作の問題**  
通常のベクトル空間での操作（加法による平行移動、線形回帰の外挿など）を単体上のデータに直接適用すると、  
- 成分が負になる  
- 総和が 1 を超える・下回る  
といった形で、**単体から外れた「あり得ない組成」**を生成してしまう。[6][10][9]

**(4) サブコンポジション不整合（subcompositional incoherence）**  
全成分を含む解析と、その部分集合（サブコンポジション）に限定した解析とで、  
- 結果の整合性が保たれない（例: 相関の符号が変わる）  
という問題が生じることがある。Aitchison は、**組成データの解析法にはサブコンポジション整合性が必要**であると主張した。[7][6]

**(5) 独立性の定義の困難さ**  
単体上では、標準的な「成分ベクトルの独立性」の概念がそのまま適用しにくく、  
- **どの比が独立なのか**  
- どの分布族（Dirichlet, logistic-normal など）が「自然」なのか  
といった点が非自明となる。この点を整理するために、Aitchison (1982) は単体上の分布クラスと様々な独立性概念を系統的に導入した。[2][1]

***

## 3. 対数比変換（log-ratio transformation）の基本的な考え方

### 3-1. 組成データの本質：絶対値ではなく「比」

Aitchison の根本的な洞察は、**組成データが本質的に伝えているのは「絶対量」ではなく「相対比」**である、という点である。[6][7]

- 組成ベクトル \(\mathbf{x} = (x_1, \dots, x_D)\) に対し、任意の正の定数 \(c>0\) でスケーリングしても、
  \[
  \mathcal{C}(c\mathbf{x}) = \mathcal{C}(\mathbf{x})
  \]
  となり（\(\mathcal{C}\) は closure 演算）、情報は変わらない。[9]
- 従って、意味を持つのは \(\frac{x_i}{x_j}\) のような**成分間の比**であり、それを数学的に扱いやすくするために対数を取る、というのが「対数比変換」の基本発想である。[11][12][6]

対数を取ることで、  
- 乗法的な比の構造が、加法的な差の構造へと変換される  
- 単体という制約付き空間から、（次元は \(D-1\) だが）**ユークリッド空間**への写像が得られ、標準的な多変量手法が適用可能になる。[11][7][6]

### 3-2. 代表的な対数比変換

組成 \(\mathbf{x} = (x_1,\dots,x_D)\)（すべて \(x_i>0\)、総和は1でも任意の \(\kappa\) でもよい）のとき、主に次の 3 種類の log-ratio 変換が用いられる。[12][7][6]

#### (1) 加法的対数比変換（additive log-ratio, alr）

ある 1 つの成分（例えば第 \(D\) 成分）を基準にとり、残りとの比の対数を取る：

\[
\operatorname{alr}(\mathbf{x}) = 
\left(
\ln\frac{x_1}{x_D},\, 
\ln\frac{x_2}{x_D},\, 
\dots,\,
\ln\frac{x_{D-1}}{x_D}
\right)
\in \mathbb{R}^{D-1}.
\]

- 計算・解釈が比較的容易で、回帰などでよく用いられる。[10][12]
- ただし「どの成分を分母にとるか」に依存した表現となる。

#### (2) 中心化対数比変換（centered log-ratio, clr）

幾何平均 \(g(\mathbf{x})\) を用いて、各成分をその幾何平均で割った比の対数を取る：

\[
g(\mathbf{x}) = \left(\prod_{i=1}^D x_i\right)^{1/D},
\]
\[
\operatorname{clr}(\mathbf{x}) = 
\left(
\ln\frac{x_1}{g(\mathbf{x})},\,
\dots,\,
\ln\frac{x_D}{g(\mathbf{x})}
\right).
\]

- 各成分が「全体の幾何平均」に対してどれくらい大きい／小さいかを表すため、対称的で直感的な解釈がしやすい。[7][6]
- ただし \(\sum_{i=1}^D \operatorname{clr}_i(\mathbf{x}) = 0\) となり、ベクトルは \(\mathbb{R}^D\) の 1 次元部分空間に制約される（有効次元は \(D-1\)）。

#### (3) 等長対数比変換（isometric log-ratio, ilr）

単体 \(\mathcal{S}^D\) 上の Aitchison 幾何をユークリッド空間 \(\mathbb{R}^{D-1}\) に**等長同型**として写すような直交基底を構成し、その基底に沿った log-ratio 座標をとる：

\[
\operatorname{ilr}(\mathbf{x}) = V^\top \ln \mathbf{x},
\]

ここで \(\ln \mathbf{x}\) は各成分の自然対数を並べたベクトル、\(V\) は列ベクトルが Aitchison 幾何における直交正規基底となる \(D \times (D-1)\) 行列である。[12][6]

- 完全にユークリッドな幾何構造（距離、内積）と整合的で、理論的に最も洗練された変換。
- 基底（バランス）をどう選ぶかは応用に依存する（例：Sequential Binary Partition によるバランス構造）。[12][6]

### 3-3. 対数比変換の効果と利点

log-ratio 変換を用いることで：

1. **単体からユークリッド空間へ**  
   制約付き空間（単体）から、制約のない（あるいは線形制約のみの）空間への写像が得られるため、  
   - 多変量正規分布  
   - 回帰分析、判別分析、クラスタリング、PCA など  
   標準的な統計手法を適用できる。[10][11][6]

2. **スケール不変性（scale invariance）と置換不変性（permutation invariance）**  
   - 全成分に同じ正の定数を掛けても結果が変わらない  
   - 成分の並び替えに対しても適切に不変（あるいは自然に対応）  
   という、組成データにとって望ましい性質を満たすように設計されている。[6][7][12]

3. **サブコンポジション整合性**  
   適切に構成された log-ratio 解析は、全成分を用いた解析と部分集合のみを用いた解析とで、整合的な結果を与える（Aitchison の 3 原則の一つ）。[7][6]

***

## 4. 入門・発展のための基礎文献

Aitchison (1982, 1986) に加えて、現在の視点から基礎を学ぶ・整理するのに適した文献として、次がよく用いられている。

- **Pawlowsky-Glahn, V., Egozcue, J.J., & Tolosana-Delgado, R. (2015).** *Modeling and Analysis of Compositional Data*.  
  Aitchison 幾何を基礎に、ilr 変換とその応用を現代的に整理した教科書。[13][7]
- **van den Boogaart, K.G., & Tolosana-Delgado, R. (2013).** *Analyzing Compositional Data with R*.  
  R パッケージ *compositions* を用いた実践的入門書で、alr/clr/ilr の実装例が豊富。[12]
- **Filzmoser, P., Hron, K., & Templ, M. (2018).** *Applied Compositional Data Analysis*.  
  ロバスト統計や外れ値を含む応用寄りの解説。[8]
- **Greenacre, M. (2018, 2022 など).**  
  実務での log-ratio 回帰や可視化に焦点をあてたガイド。[11][12]
- **Recent review:**  
  Greenacre (2025), “Compositional Data Analysis,” *Annual Review of Statistics and Its Application* – log-ratioアプローチと代替法を俯瞰した最新レビュー。[11]

これらはすべて Aitchison (1982, 1986) の枠組みを前提にしているため、まず Aitchison の論文・書籍で原理を押さえ、その後これらの教科書・レビューで現代的な発展と実装を学ぶ、という読み方がよく推奨されている。[8][6][11]

***

以上が、組成データ分析の基礎として重要な Aitchison (1982, 1986) の書誌情報と、単体上の統計的課題、および対数比変換の基本的な考え方である。さらに具体的な応用（回帰、クラスタリング、ゼロ処理など）に進みたい場合は、上記の教科書と近年のガイドライン論文を併読すると体系的に整理しやすい。[12]

[1](http://leg.est.ufpr.br/lib/exe/fetch.php/pessoais:abtmartins:thestatisticalanalysisofcompositionaldata.pdf)
[2](https://www.jstor.org/stable/2345821)
[3](https://www.ajs.or.at/index.php/ajs/article/view/1066)
[4](https://search.worldcat.org/title/The-statistical-analysis-of-compositional-data/oclc/13215689)
[5](https://onlinelibrary.wiley.com/doi/abs/10.1002/bimj.4710300705)
[6](https://compositionaldata.com/material/others/Lecture_notes_11.pdf)
[7](http://www.sediment.uni-goettingen.de/staff/tolosana/extra/CoDa.pdf)
[8](https://journals.sagepub.com/doi/10.1177/21582440221093366?icid=int.sj-full-text.similar-articles.5)
[9](https://en.wikipedia.org/wiki/Compositional_data)
[10](https://www.vvsor.nl/wp-content/uploads/2020/06/KM1996051004.pdf)
[11](https://www.annualreviews.org/doi/pdf/10.1146/annurev-statistics-042720-124436)
[12](https://pmc.ncbi.nlm.nih.gov/articles/PMC12176406/)
[13](https://www.sciencedirect.com/special-issue/10F7FJJ8R6T)
[14](https://dugi-doc.udg.edu/bitstream/handle/10256/21771/StatisticalAnalysis.pdf?sequence=1)
[15](https://www.sciencedirect.com/science/article/abs/pii/S0048969710004845)
